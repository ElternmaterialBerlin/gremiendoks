<!DOCTYPE html>
<html lang="de">
<head>
<title>
  Wahlprotokoll der Klassenelternversammlung (Berlin)
</title>
<meta charset="UTF-8"/>
<meta name="description"
  content="Wahlen in der Elternversammlung der Klasse durchführen und protokollieren"/>
<meta name=”robots” content="index, follow">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style type="text/css">
  :root {
    --year: "2023/2024";
    --npages: "";
  }

  body {
/*  position: absolute scheint page-breaks in Chrom(e/ium) zu
    verhindern:*/
/*     position: absolute; */
    background-color: white;
    height:100%;
    width:100%;
    box-sizing: border-box;
    padding: 0cm;
    margin: 0mm;
    font-family: Arial, Helvetica, sans-serif;
    /*Verhindert Abstände zwischen Seiten:*/
    line-height: 0pt;
    font-size: 0pt;
    counter-reset: pn;
  }
  .page {
    box-sizing: border-box;
    position: relative;
    display: block;
    margin: 0mm;
    padding: 0mm;
    width: 210mm;
    height: 296.6mm;
    /*Normale Werte:*/
    font-size: 11pt;
    /*Das macht nicht alles konsistent, siehe
      https://bugs.chromium.org/p/chromium/issues/detail?id=1023654 */
    line-height: 1.1;
  }
  .vhpage {/*variable Höhe*/
    box-sizing: border-box;
    position: relative;
    display: block;
    margin: 0mm;
    padding: 10mm;
    width: 210mm;
    /*Normale Werte:*/
    font-size: 11pt;
    /*Das macht nicht alles konsistent, siehe
      https://bugs.chromium.org/p/chromium/issues/detail?id=1023654 */
    line-height: 1.1;
  }
  .content {
    margin: 0px;
    padding: 0px;
    position: absolute;
    left: 10mm;
    right: 10mm;
    top: 10mm;
    bottom: 10mm;
  }
  .vhpage .content {
    position: static;
    height: auto;
  }
  .expl {/*kleine erläuternde Texte*/
    font-size: 9pt;
  }
  .footerl {
    font-size: 8pt;
    position: absolute;
    bottom: 10mm;
    height: 5mm;
    left: 10mm;
  }
  .footerr {
    font-size: 8pt;
    position: absolute;
    bottom: 10mm;
    height: 5mm;
    right: 10mm;
  }
  .doprint .pn::after {
    counter-increment: pn;
    content: counter(pn);
  }
  .np::after {
    content: var(--npages);
  }
  .yr::after {
    content: var(--year);
  }

  @media print {
    @page {
      size: auto;
      margin: 0mm;
    }
    .page {
      /*nur für Debugging:*/
/*       background-color: #efefff;
       border: solid 1px; */
      /*Ende Debugging*/

/*       break-after: page; */
      break-inside: avoid-page;
    }
    .guiheader {
      display: none;
    }
    .noprint {
      display: none;
    }
    .anleitung {
      display: none;
    }

    select {
      appearance: none;
      border-bottom: 1px solid;
    }

    a:link {
      text-decoration: inherit;
      color: inherit;
    }
  }
  @media screen {
    .page, .vhpage {
      background-color: #efefff;
      border: solid 1px;
    }
    .content {
  /*     border: dashed; */
      background-color: white;
    }
    .guiheader {
      font-size: 8pt;
      position: absolute;
      top: 0mm;
      height: 10mm;
/*       width: 15mm; */
      padding-left: 2mm;
      padding-right: 2mm;
      right: 0mm;
      text-align: center;
      background-color: #b0ff80;
    }
    .guiheader_edit {
      left: 0mm;
      right: auto;
    }
    .guielement {
      cursor: pointer;
      color: red;
      font-size:25pt;
      margin-left: 1mm;
    }
    .cloneable .morepages::after {
      content: "+";
    }
    .noprint .morepages::after {
      content: "+";
    }
    .doprint .lesspages::after {
      content: "x";
    }
    .noprint .lesspages::after {
      content: "";
    }

    .guielement_small {
      display: inline-block;
      max-width: 18mm;
      cursor: pointer;
      color: red;
      margin-left: 1mm;
      margin-top: 1mm;
    }

    .noprint {
      filter: contrast(50%);
    }

    .smallonly {
      display: none;
    }
  }

  h1 {/*Wahlprotokoll fuer ...*/
    text-align: center;
    font-size: 21pt;
    margin-top: 5mm;
    margin-bottom: 0.5mm;
  }

  .subhead {/*basierend...*/
    text-align: center;
    font-size: 8pt;
    margin-top: 0pt;
    margin-bottom: 2mm;
  }

  h2 {/*Schritte der Wahl*/
    text-align: left;
    font-weight: bold;
    font-size: 11pt;
    margin-top: 2mm;
    margin-bottom: 0pt;
  }

  h3 {/*Gremien/Ämter*/
    text-align: left;
    font-weight: bold;
    font-size: 14pt;
    margin-top: 0pt;
    margin-bottom: 2mm;
  }

  h4 {/*Kandidierende*/
    text-align: left;
    font-weight: normal;
    font-size: 11pt;
    margin-top: 4mm;
    margin-bottom: 2mm;
    text-decoration: underline;
    text-decoration-thickness: 0.5pt;
    text-underline-offset: 1pt;
    padding: 0pt;
  }

  h5 {/*Wahlergebnis*/
    text-align: left;
    font-weight: bold;
    font-size: 11pt;
    margin-top: 3mm;
    margin-bottom: 1mm;
/*     border: 2pt solid #808080; */
/*     padding: 0pt 1pt 0pt 1pt; */
    color : white;
    background-color: #808080;
  }

  p {
    padding: 0mm;
    margin: 0mm;
    margin-top: 3mm;
    margin-bottom: 3mm;
  }

  .erlaeuterung {
    font-family: Arial, Helvetica, sans-serif;
    margin-top: 0pt;
    text-align: justify;
    font-size: 8pt;
    hyphens: auto;
    -webkit-hyphens: auto;
  }

  ul, ol {
    margin-top: 2mm;
    padding-top: 0pt;
    margin-bottom: 2mm;
    padding-bottom: 0pt;
  }

  .haupttext {
    font-family: Arial, Helvetica, sans-serif;
    margin-top: 0pt;
    text-align: justify;
    font-size: 11pt;
    hyphens: auto;
    -webkit-hyphens: auto;
  }

  td, th {
    margin: 0mm;
    padding: 1pt;
  }

  .tabellebreit {
    box-sizing: border-box;
    width: 100%;
    border-collapse: collapse;
  }
  .tabellebreit th {
    box-sizing: content-box;
    border: 1pt solid;
    height: 4.7mm;
    font-size: 11pt;
    font-weight: normal;
  }
  .tabellebreit td {
    box-sizing: content-box;
    border: 1pt solid;
    height: 7mm;
  }

  .doppelzeilen td {
    height: 14mm;
    vertical-align: top;
  }

  .wahlerg {
/*     background-color: #d9d9d9; */

    border: 2pt solid #808080;
/*     margin-bottom: -2pt; */
/*     margin-bottom: 4mm; */
  }

  .wahlerg th {
    border: 2pt solid #808080;
    background-color: #808080;
    color: white;
  }
/*  .wahlerg .iptab {
    background-color: #d9d9d9;
  }*/

  .tabelleohnerahmen {
    width: 100%;
    padding: 0px;
    border-spacing: 0pt;
  }

  .iptab {
    border: none;
    height: 100%;
    margin: 0pt;
    box-sizing: border-box;
    width: 100%;
    resize: none;
  }

  .ipcb {
    margin: 0pt;
    border: none;
    padding: 0pt;
    width: 100%;
    filter: opacity(0%);
    margin-right: -70%;
  }

  .ipcb:checked ~ a::after{
    font-size: 100%;
    content: "X";
    pointer-events: none;
  }

  .spnamen {
    width: 8cm;
  }

  .sprang {
    width: 4mm;
  }

  .spfach {
    width: 2cm;
  }

  .spunters {
    width: 6cm;
  }

  input {
    font: inherit;
    border: none;
    border-bottom: 1pt solid;
    padding: 1pt;
    margin: 0pt;
  }

  label {
/*     font-size: 11pt; */
    padding: 0pt;
    margin-left: 0pt;
  }

  select {
    font: inherit;
    border: none;
    border-bottom: 1px solid;
    background-color: inherit;
    padding: 0pt;
    margin: 0pt;
  }

  #schulez {
    padding: 0pt;
    margin-left: 0pt;
  }

  #schule {
    width: 9cm;
  }

  #klasse {
    width: 1cm;
  }

  #datumz {
    text-align: right;
  }

  #datum {
    width: 4cm;
  }

  #anwesend, #stimmen {
    width: 1.2cm;
  }

  #wahlleitung {
    width: 15cm;
  }

  .anz  {
    width: 1cm;
  }

  .wahltyp  {
    width: 2cm;
  }

  .docxonly {
    display: none;
  }

  @media screen and (max-width: 800px) {
    .smallonly {
      display: block;
    }

    .page, .vhpage {
/*       background-color: #ff0000; */
      width: 100%;
      height: auto;
      display: inline-block;
      padding: 5px;
      font-size: 13pt;
    }

    .erlaeuterung, .haupttext, .tabellebreit, h2, h3, h4, h5 {
      font-size: 13pt;
    }

    .guielement_small, .guielement {
      background-color: white;
      display: block;
      width: auto;
      overflow: visible;
      border: 1px solid black;
      top: auto;
      left: auto;
      right: auto;
      bottom: auto;
      margin: 3px;
      padding: 2px;
      max-width: none;

    }

    .guiheader {
      position: relative;
      font-size: 13pt;
      display: block;
      height: auto;
      width: auto;
      padding: 5px;

    }

    .content {
      position: static;
      height: auto;
      width: 95%;
      background-color: white;
      padding: 7px;
      padding-right: 10px;
      margin: 5px;
    }
    .footerl, .footerr {
      position: relative;
      bottom: auto;
      display: inline-block;
      left: auto;
      right: auto;
    }

    #schule, #klasse, #wahlleitung, #datum {
      width: 2cm;
    }
  }
</style>
<script>
  "use strict";
  const loadScriptAsync = function(src){
    (async () => {await import(src)})()
  }

  const storage = window.localStorage;
  var cmperpx;
  const globRules = {};
  const woUnit = function(s){
    return s.replace(/#|pt|mm|cm|px/,"");
  };
  const firstFont = function(fts){
    return fts.replace(/,.*/,"");
  };

  var year = (new Date()).getFullYear();
  year = year + "/" + (year+1);
  const url = window.location.pathname;
  const selffn = url.substring(url.lastIndexOf("/")+1);
  const editPrefix = "..edit.";
  const fieldPrefix = "..data.";
  const objStore = {};
  const getItem = function(id,prefix){
    prefix = prefix ? prefix : "";
    prefix = selffn+"_"+prefix;
    const val = storage.getItem(prefix+id);
    if(val){
      objStore[prefix] = objStore[prefix] ? objStore[prefix] : {};
      objStore[prefix][id] = val;
    }
    return val;
  };
  const setItem = function(id,val,prefix){
    prefix = prefix ? prefix : "";
    prefix = selffn+"_"+prefix;
    objStore[prefix] = objStore[prefix] ? objStore[prefix] : {};
    objStore[prefix][id] = val;
    return storage.setItem(prefix+id,val);
  };
  const removeItem = function(id,prefix){
    prefix = prefix ? prefix : "";
    prefix = selffn+"_"+prefix;
    objStore[prefix] = objStore[prefix] ? objStore[prefix] : {};
    delete objStore[prefix][id];
    return storage.removeItem(prefix+id);
  };

  const download = function(fn,text) {
    const el = document.createElement("a");
    el.setAttribute("href",
      "data:text/plain;charset=utf-8," + encodeURIComponent(text));
    el.setAttribute("download", fn);
    el.style.display = "none";
    document.body.appendChild(el);
    el.click();
    document.body.removeChild(el);
  };

  const downloadBlob = function(fn,blob) {
    const el = document.createElement("a");
    el.setAttribute("href",URL.createObjectURL(blob))
    el.setAttribute("download", fn);
    el.style.display = "none";
    document.body.appendChild(el);
    el.click();
    document.body.removeChild(el);
    URL.revokeObjectURL(el.href);
  };

  const upload = function(cb) {
    const fr = new FileReader();
    fr.onload= function(){
      cb(fr.result);
    };
    const el = document.createElement("input");
    el.setAttribute("type","file");
    el.onchange = function(){
      fr.readAsText(this.files[0],'UTF-8');
    }
    el.style.display = "none";
    document.body.appendChild(el);
    el.click();
    document.body.removeChild(el);
  };

  const dlSelf = function(){
    if (hasClones()){
      warnClones();
      //Kein return, damit Änderungen dennoch gesichert werden können.
    }
    download(selffn,"<!DOCTYPE html>\n<html lang=\"de\">\n"+
      document.documentElement.innerHTML+"\n</html>"
    );
  };

  const exportObjStore = function(fn,prefix){
    const obj = prefix ? objStore[selffn+"_"+prefix] : objStore;
    download(fn,JSON.stringify(obj));
  };

  const importJsonToStores = function(js,prefix){
  var obj;
    try {
      obj = JSON.parse(js);
      if (!obj || !typeof(obj) == "object"){
        throw "Invalid import.";
      }
    } catch (e) {
      alert("Import fehlgeschlagen, kein korrektes JSON-Objekt.")
      return;
    }
    for(const id in obj){
      setItem(id,obj[id],prefix);
    }
  };

  const saveField = function(fld){
    fld = fld instanceof HTMLElement ? fld : this;
    if (fld.id && fld.id != ""){
      switch(fld.type){
        case "checkbox":
          setItem(fld.id,fld.checked?"on":"off",fieldPrefix);
          break;
        default:
          setItem(fld.id,fld.value,fieldPrefix);
      }
    }
  };

  const loadField = function(fld){
    fld = fld instanceof HTMLElement ? fld : this;
    const stored = getItem(fld.id,fieldPrefix)
    if (stored){
      switch(fld.type){
        case "checkbox":
          fld.checked = (stored == "on");
          break;
        default:
          fld.value = stored;
      }
    }
  };

  const deleteSavedField = function(fld){
    if (fld.id && fld.id != ""){
      removeItem(fld.id,fieldPrefix);
    }
  };

  const saveElement = function(el){
    if (el.id && el.id != ""){
      setItem(el.id,el.innerHTML,editPrefix);
    }
  };

  const loadElement = function(el){
    if (el.id && el.id != ""){
      const stored = getItem(el.id,editPrefix);
      if (stored){
        el.innerHTML = stored;
      }
    }
  };

  const deleteSavedElement = function(el){
    if (el.id && el.id != ""){
      removeItem(el.id,editPrefix);
    }
  };

  const clearFields = function(){
    const flds  = document.querySelectorAll("input,select,textarea");
    for(const fld of flds){
      switch(fld.type){
        case "checkbox":
          fld.checked = false;
          break;
        default:
          fld.value = fld.defaultValue;
      }
      deleteSavedField(fld);
    }
    location.reload();
  };

  const exportFields = function(){
    exportObjStore(selffn+"_daten.json",fieldPrefix);
  };

  const importFields = function(){
    upload(function(js){
      importJsonToStores(js,fieldPrefix);
      location.reload();
    });
  };

  var allowEdits = false;
  const edicls = ["haupttext","erlaeuterung"];
  const editags = ["H1","H2","H3","H4","H5","TH","OL","UL"];

  const flipEdit = function(){
    if(hasClones()){
      warnClones();
      return;
    }
    allowEdits = !allowEdits;
    for (const c of edicls) {
      const cl = document.getElementsByClassName(c);
      for(let i=0;i<cl.length;++i) {
        cl[i].contentEditable = allowEdits;
      }
    }
    for (const t of editags) {
      const tl = document.getElementsByTagName(t);
      for(let i=0;i<tl.length;++i) {
        tl[i].contentEditable = allowEdits;
      }
    }
  };

  const loadEdits = function(){
    for (const c of edicls) {
      const cl = document.getElementsByClassName(c);
      for(let i=0;i<cl.length;++i) {
        const el = cl[i];
        el.id = c+"_"+i;
        loadElement(el);
      }
    }
    for (const t of editags) {
      const tl = document.getElementsByTagName(t);
      for(let i=0;i<tl.length;++i) {
        const el = tl[i];
        el.id = t+"_"+i;
        loadElement(el);
      }
    }
  };

  const revertEdits = function(){
    for (const c of edicls) {
      const cl = document.getElementsByClassName(c);
      for(let i=0;i<cl.length;++i) {
        const el = cl[i];
        el.id = c+"_"+i;
        deleteSavedElement(el);
      }
    }
    for (const t of editags) {
      const tl = document.getElementsByTagName(t);
      for(let i=0;i<tl.length;++i) {
        const el = tl[i];
        el.id = t+"_"+i;
        deleteSavedElement(el);
      }
    }
    location.reload();
  };

  const childNodesToDocx = function(el){
    const {Paragraph, TextRun, HeadingLevel, Table, TableRow,
      TableCell, WidthType, HeightRule, BorderStyle} = docx;
    const children = [];
    let trim = true;
    for (const ch of el.childNodes){
      let r
      if(ch.nodeType == Node.TEXT_NODE){
        let t = ch.nodeValue.replaceAll(/[\t\n\r ]+/ig," ");
        if (trim) t = t.trimStart();
        trim = false;
        r = new TextRun(t)
      } else if (ch.nodeType == Node.ELEMENT_NODE){
        r = elToDocx(ch);
        trim = ch.tagName.toLowerCase() == "br";
      }
      if (r && r.constructor.name == "Array"){
        for (const ri of r){
          children.push(ri);
        }
      } else if (r){
        children.push(r);
      }
    }
    return children;
  };

  const elToDocx = function(el,opt){
    const {Paragraph, TextRun, HeadingLevel, Table, TableRow,
      TableCell, WidthType, HeightRule, BorderStyle,
      ExternalHyperlink} = docx;
    const tn = (el.tagName?el.tagName:"").toLowerCase();
    const cl = el.className;
    if (/htmlonly/.test(cl)){
      return null;
    }

    if (/h[0-9]/.test(tn)) {
      return new Paragraph({ children: childNodesToDocx(el),//textContent,
        heading: HeadingLevel["HEADING_"+tn[1]],
      });
    } else if (tn =="p" && /subhead|erlaeuterung|haupttext/.test(cl)) {
      return new Paragraph({ children: childNodesToDocx(el),//textContent,
        style: cl.match(/subhead|erlaeuterung|haupttext/),
      });
    } else if (tn == "label") {
        return new TextRun({text: el.innerText});
    } else if (tn == "a" && el.href) {
        return new ExternalHyperlink({
          link: el.href,
          children: [new TextRun({
            text: el.innerText,
            style: "Hyperlink"})
          ]
        });
    } else if (/span|^a$/.test(tn) && cl=="erlaeuterung") {
        return new TextRun({
          text: el.innerText,
          style: "erlaeuterungInline"
        });
    } else if (/strong|^b$/.test(tn)) {
        return new TextRun({text: el.innerText, bold: true});
    } else if (/^i$|em/.test(tn)) {
        return new TextRun({text: el.innerText, italics: true});
    } else if (tn == "br") {
        return new TextRun({text: "", break: 1});
    } else if (/input|select/.test(tn)) {
        let s = el.value;
        if (tn == "select"){
          if(el.selectedIndex == -1 ||
              el.options[el.selectedIndex].value == "none"){
            let first = true;
            s = "";
            for (const o of el.options){
              s = s+(first?"":"/")+
                (o.value=="none"?"":o.innerText.trim());
              first = (s == "");
            }
          } else {
            s = el.options[el.selectedIndex].innerText.trim();
          }
        }

        const w = el.offsetWidth/18;
        while(s.length < w){
          s = s + " ";
        }
        return [
          new TextRun({text: s, style: "input"}),
          //kleiner Hack, um unterstrichenen Whitespace auch
          //anzuzeigen (Word/OnlyOffice):
          new TextRun({text:".", color: "FFFFFF"}),
        ];
    } else if  (/tabellebreit/.test(cl)) {
      const wahlerg = /wahlerg/.test(cl);
      const bdcolor = wahlerg?"808080":"000000";
      const bdsize = wahlerg?16:8;
      const parstyle = wahlerg?"wahlergTH":"tabhead";
      const theadr = el.getElementsByTagName("thead")[0].
        getElementsByTagName("tr")[0];
      const hcells = [];
      const cw = [];
      for (const ch of theadr.children){
        hcells.push(new TableCell({
          children: [new Paragraph({
            children: childNodesToDocx(ch),
            style: parstyle,
            alignment: docx.AlignmentType.CENTER,
            spacing: {
              before: 0,
              after: 0,
              line: 240
            },
            })
          ],
          shading: {
            // fill: "808080",
            type: docx.ShadingType.SOLID,
            color: wahlerg?"808080":"FFFFFF",
          },
          margins: {
              top: 14,
              bottom: 14,
              left: 56,
              right: 56,
          },
          borders: {
            top: { color: bdcolor, size: bdsize, style: BorderStyle.SINGLE},
            bottom: { color: bdcolor, size: bdsize, style: BorderStyle.SINGLE},
            left: { color: bdcolor, size: bdsize, style: BorderStyle.SINGLE},
            right: { color: bdcolor, size: bdsize, style: BorderStyle.SINGLE},
          },
          width: {
            size: Math.floor(ch.offsetWidth*cmperpx*567),
            type: WidthType.DXA,
          }
        }));
        cw.push(Math.floor(ch.offsetWidth*cmperpx*567));
      }
      const rows = [new TableRow({
        children: hcells,
        height: {
          value: Math.floor(0.9*theadr.firstElementChild.clientHeight*cmperpx*567),//266,//0.47*567
          rule: HeightRule.EXACT,
        }
      })];

      for (const tr of el.getElementsByTagName("tbody")[0].
        getElementsByTagName("tr")){
        const trcells = [];
        for (const ch of tr.children){
          const ip = ch.getElementsByTagName("input")[0];
          trcells.push(new TableCell({children:[
            new Paragraph({children:[new TextRun(ip?ip.value:"")],
              style: "tabcellpg"
              })
          ]}));
        }
        rows.push(new TableRow({
          children: trcells,
          height: {
            value: Math.floor(0.9*tr.firstElementChild.clientHeight*cmperpx*567),
            rule: HeightRule.EXACT,
          }
        }))
      }

      return new Table({rows: rows,
        columnWidths : cw,
        width: {
          size: 100,
          type: docx.WidthType.PERCENTAGE,
        },
        borders: {
          top: { color: bdcolor, size: bdsize, style: BorderStyle.SINGLE},
          bottom: { color: bdcolor, size: bdsize, style: BorderStyle.SINGLE},
          left: { color: bdcolor, size: bdsize, style: BorderStyle.SINGLE},
          right: { color: bdcolor, size: bdsize, style: BorderStyle.SINGLE},
          insideHorizontal: { color: "000000", size: 4, style: BorderStyle.SINGLE},
          insideVertical: {color: "000000", size: 4, style: BorderStyle.SINGLE},
        },
      });
    } else if  (/tabelleohnerahmen/.test(cl)) {
      let first = true;
      const cw = [];
      const rows = [];

      for (const tr of el.getElementsByTagName("tbody")[0].
        getElementsByTagName("tr")){
        const trcells = [];
        for (const ch of tr.children){
          trcells.push(new TableCell({
            children:[
              new Paragraph({
                children:childNodesToDocx(ch),
                style: "tabcellpg",
                })
            ],
            margins: {
                top: 0,
                bottom: 0,
                left: 0,
                right: 0,
            },
            width: {
              size: Math.floor(ch.offsetWidth*cmperpx*567),
              type: WidthType.DXA,
            }
          }));
          if (first){
            cw.push(Math.floor(ch.offsetWidth*cmperpx*567));
          }
        }
        rows.push(new TableRow({
          children: trcells,
          height: {
            value: tr.offsetHeight*cmperpx*567,
            rule: HeightRule.EXACT,
          }
        }))
        first = false;
      }

      return new Table({rows: rows,
        columnWidths : cw,//[3800,1000,2000],
        width: {
          size: 100,
          type: docx.WidthType.PERCENTAGE,
        },
        borders: {
          top: {style: BorderStyle.NONE},
          bottom: {style: BorderStyle.NONE},
          left: {style: BorderStyle.NONE},
          right: {style: BorderStyle.NONE},
          insideHorizontal: {style: BorderStyle.NONE},
          insideVertical: {style: BorderStyle.NONE},
        },
      });
    } else if  (/^p$|table/.test(tn)) {
      const children = [];
      // const children = [new TextRun({
      //   text: cl+tn
      // })];
      for (const ch of el.children){
        const r = elToDocx(ch);
        if (r){
          children.push(r);
        }
      }
      return new Paragraph({children: children});
    } else if  (/^ul$|^ol$/.test(tn)) {
      const ret = [];

      for (const ch of el.children){
        const r = elToDocx(ch,{listType:tn});
        if (r){
          ret.push(r);
        }
      }
      return ret;
    } else if  (tn == "li") {
      if (opt && opt.listType == "ol"){
        return new Paragraph({children: childNodesToDocx(el),
          numbering: {
            reference: "global",
            level: 0,
          },
        });
      } else {
        return new Paragraph({children: childNodesToDocx(el),
          bullet: {level: 0}
        });
      }
    } else {
      return new TextRun({
        color: "FF0000",
        text: "unsupported: <" + cl+tn + el.innerText+">",
      });
    }
  }

  const saveDocx = async function(){
    if (!confirm(
      "Dies lädt externe JavaScript-Bibliotheken nach "+
      "(funktioniert also nur online). Die Formular-Daten werden "+
      "weiterhin ausschließlich im Browser verarbeitet. "+
      "Fortfahren?"
    )){
      return;
    }
    await import("https://unpkg.com/docx@8.0.4/build/index.js");

    const sections = [];

    const pages = document.querySelectorAll(".page,.vhpage");
    let pn = 0;
    for(let i=0;i<pages.length;++i) {
      const page = pages[i];
      if (page.className.indexOf("noprint") != -1){
        continue;
      }
      const isVH = /vhpage/.test(page.className);
      const cnt = page.getElementsByClassName("content")[0];
      const secch = [];

      for(const el of cnt.children) {
        const ch = elToDocx(el);
        if(ch){
          if (ch.constructor.name == "Array"){
            for(const gch of ch){
              secch.push(gch);
            }
          } else {
            secch.push(ch);
          }
        }
      }

      const footerl = page.getElementsByClassName("footerl")[0];
      const flMain = (footerl && footerl.getAttribute("data-main"))?
        footerl.getAttribute("data-main"):defaultFooterMain;
      const flSub = (footerl && footerl.getAttribute("data-sub"))?
        footerl.getAttribute("data-sub"):"";
      const frexists = page.getElementsByClassName("footerr")[0] &&
        true;
      let frcontent = "";
      if(frexists){
        pn++;
        frcontent = "Seite " + pn + "/" + npages;
      }
      //Alternative way to usage of section.type to ensure a page break
      // secch.push(new docx.Paragraph(
      //   {children: [new docx.PageBreak()]}
      // ));
      sections.push({
        properties: {
          type: docx.SectionType.NEXT_PAGE,
          page: {
            size: {
              orientation: (isVH ||
                woUnit(globRules.Cpage.height)>
                woUnit(globRules.Cpage.width))?"portrait":"landscape",
              width: 11907,
              height: 16839,
            },
            margin: {
              top: 1*567,//567=1cm
              right: 1*567,
              bottom: 1*567,
              left: 1*567,
            }
          },
        },
        children:secch,
        footers: {
          default: new docx.Footer({
            children: [new docx.Paragraph({
              children : [
                new docx.TextRun(flMain+" "+year+"\t\t"+frcontent),
                new docx.TextRun({text: "", break: 1}),
                new docx.TextRun(flSub)
              ],
              tabStops: [
                {
                  type: docx.TabStopType.CENTER,
                  position: docx.TabStopPosition.MAX /2,
                },{
                  type: docx.TabStopType.RIGHT,
                  position: docx.TabStopPosition.MAX,
                },
              ],
            })],
          }),
        },
      });
    }

    const doc = new docx.Document({
      creator: "ElternmaterialBerlin",
      title: document.title,
      description: document.querySelector("meta[name='description']").content,
      sections: sections,
      numbering: {
        config: [{
            reference: "global",
            levels: [{
                  level: 0,
                  format: docx.LevelFormat.DECIMAL,
                  text: "%1.",
              },{
                  level: 1,
                  format: docx.LevelFormat.DECIMAL,
                  text: "%1.%2.",
              },{
                  level: 2,
                  format: docx.LevelFormat.DECIMAL,
                  text: "%1.%2.%3.",
              },
            ],
        }],
      },
      styles: {
        default: {
          listParagraph : {
            run: {
              size: woUnit(globRules.Cpage.fontSize)*2,//pt->half points
            }
          }
        },
        paragraphStyles: [
          {
            id: "Normal",
            name: "Normal",
            // basedOn: "Normal",
            // next: "Normal",
            quickFormat: true,
            run: {
              color: "000000",
              font: firstFont(globRules.body.fontFamily),
              language: {
                value: "de-DE",
              },
            },
            paragraph: {
              spacing: {
                before: woUnit(globRules.p.marginTop)*56,//unit mm
                after: woUnit(globRules.p.marginBottom)*56,
            //         line: 276,
              },
            //     indent: {
            //         left: 720,
            //     },
            },
          },{
            id: "Heading1",
            name: "Heading 1",
            basedOn: "Normal",
            next: "Normal",
            quickFormat: true,
            run: {
              size: 2*woUnit(globRules.h1.fontSize)
            },
            paragraph : {
              alignment: docx.AlignmentType.CENTER,
              spacing: {
                before: woUnit(globRules.h1.marginTop)*56,
                after: woUnit(globRules.h1.marginBottom)*56,
              },
            }
          },{
            id: "subhead",
            name: "Sub-Heading",
            basedOn: "Normal",
            next: "Normal",
            quickFormat: true,
            run: {
              size: woUnit(globRules.Csubhead.fontSize)*2
            },
            paragraph : {
              alignment: docx.AlignmentType.CENTER,
              spacing: {
                before: woUnit(globRules.Csubhead.marginTop)*56,
                after: woUnit(globRules.Csubhead.marginBottom)*56,
              },
            }
          },{
            id: "Heading2",
            name: "Heading 2",
            basedOn: "Normal",
            next: "Normal",
            quickFormat: true,
            run: {
              bold: true,
              size: woUnit(globRules.h2.fontSize)*2
            },
            paragraph : {
              spacing: {
                before: woUnit(globRules.h2.marginTop)*56,
                after: woUnit(globRules.h2.marginBottom)*56,
              },
            }
          },{
            id: "Heading3",
            name: "Heading 3",
            basedOn: "Normal",
            next: "Normal",
            quickFormat: true,
            run: {
              bold: true,
              size: woUnit(globRules.h3.fontSize)*2
            },
            paragraph : {
              spacing: {
                before: woUnit(globRules.h3.marginTop)*56,
                after: woUnit(globRules.h3.marginBottom)*56,
              },
            }
          },{
            id: "Heading4",
            name: "Heading 4",
            basedOn: "Normal",
            next: "Normal",
            quickFormat: true,
            run: {
              size: woUnit(globRules.h4.fontSize)*2,
              underline: {
                type: docx.UnderlineType.SINGLE,
              },
            },
            paragraph : {
              spacing: {
                before: woUnit(globRules.h4.marginTop)*56,
                after: woUnit(globRules.h4.marginBottom)*56,
              },
            }
          },{
            id: "Heading5",
            name: "Heading 5",
            basedOn: "Normal",
            next: "Normal",
            quickFormat: true,
            run: {
              bold: true,
              color: "FFFFFF",
              size: woUnit(globRules.h5.fontSize)*2,
            },
            paragraph : {
              spacing: {
                before: woUnit(globRules.h5.marginTop)*56,
                after: woUnit(globRules.h5.marginBottom)*56,
              },
              shading: {
                type: docx.ShadingType.SOLID,
                color: "808080",
              },
            }
          },{
            id: "tabcellpg",
            name: "TabCellPG",
            basedOn: "Normal",
            next: "Normal",
            quickFormat: true,
            paragraph : {
              spacing: {
                before: 0,
                after: 0,
                line: 240
              },
            }
          },{
            id: "tabhead",
            name: "Tabhead",
            basedOn: "tabcellpg",
            next: "Normal",
            quickFormat: true,
            paragraph : {
              alignment: docx.AlignmentType.CENTER,
            }
          },{
            id: "wahlergTH",
            name: "wahlergTH",
            basedOn: "tabhead",
            next: "Normal",
            quickFormat: true,
            run: {
              color: "FFFFFF",
            },
          },{
            id: "erlaeuterung",
            name: "Erläuterungen",
            basedOn: "Normal",
            next: "Normal",
            quickFormat: true,
            run: {
              //scheint nicht zu funktionieren, daher darunter erneut:
              // style: "erlaeuterungInline",
              color: "000000",
              size: woUnit(globRules.Cerlaeuterung.fontSize)*2,
            },
            paragraph : {
              //eigentlich docx.AlignmentType.JUSTIFIED, aber
              //die Algorithmen für Blocksatz in Office-Programmen
              //sind zu schlecht.
              alignment: docx.AlignmentType.LEFT,
            }
          },{
            id: "haupttext",
            name: "Haupttext",
            basedOn: "Normal",
            next: "Normal",
            quickFormat: true,
            run: {
              color: "000000",
              size: woUnit(globRules.Chaupttext.fontSize)*2
            },
            paragraph : {
              //eigentlich docx.AlignmentType.JUSTIFIED, aber
              //die Algorithmen für Blocksatz in Office-Programmen
              //sind zu schlecht.
              alignment: docx.AlignmentType.LEFT,
            }
          },
        ],
        characterStyles: [
          {
            id: "input",
            name: "Eingabefeld",
            basedOn: "Normal",
            next: "Normal",
            quickFormat: true,
            run: {
              color: "000000",
              // size: 2*11,
              underline: {
                type: docx.UnderlineType.SINGLE,
              },
            },
          },{
            id: "erlaeuterungInline",
            name: "Erläuterung",
            basedOn: "Normal",
            next: "Normal",
            quickFormat: true,
            run: {
              color: "000000",
              size: woUnit(globRules.Cerlaeuterung.fontSize)*2,
            },
          },
        ]
    }});

    docx.Packer.toBlob(doc).then((blob) => {
        downloadBlob("ev-wahlprotokoll.docx",blob)
    });
  };

  const defaultFooterMain = "Wahlprotokoll Klassen-EV";
  const updateFooters = function(){
    for (const footerl of document.getElementsByClassName("footerl")){
      const main = footerl["data-main"]?footerl["data-main"]:defaultFooterMain;
      const sub = footerl.getAttribute("data-sub")?
        footerl.getAttribute("data-sub"):"";
      footerl.innerHTML = main+" "+year + "<br/>"+sub
    }
  };


  const createTableRows = function(){
    for (const tab of document.getElementsByTagName("table")){
      const nrows = tab.getAttribute("data-nrows");
      if (!nrows) continue;
      const ncols = tab.getElementsByTagName("th").length;
      if (ncols == 0) continue;
      const tbody = tab.getElementsByTagName("tbody")[0];
      if (!tbody) continue;
      const tr = tbody.getElementsByTagName("tr")[0];

      let cellstr = "";
      for(let i=0;i<nrows;i++){
        cellstr = cellstr + "<tr>\n";
        if (tr){
          cellstr = cellstr + tr.innerHTML;
        } else {
          for(let j=0;j<ncols;j++){
            cellstr = cellstr + "  <td><input class='iptab'/></td>\n";
          }
        }
        cellstr = cellstr + "</tr>\n";
      }

      tbody.innerHTML = cellstr;
    }
  };

  var observer;
  var npages;
  var npagesChanged = function(){};
  var nclones;
  try {
    nclones = JSON.parse(getItem("..nclones"));
    if (!nclones || !typeof(nclones) == "object"){
      throw "No nclones saved.";
    }
  } catch (e) {
    nclones = {};
  }
  const ol = function(){
    "use strict";

    createTableRows();

    const flds  = document.querySelectorAll("input,select,textarea");
    const usedids = {};
    for(const fld of flds){
      if (!fld.id || fld.id == ""){
        var par = fld.parentNode
        var gp = par.parentNode
        const colNr = Array.prototype.indexOf.call(gp.children,par)
        par = gp;
        gp = par.parentNode;
        const tab = gp.parentNode;
        const rowNr = Array.prototype.indexOf.call(gp.children,par);
        const colid = tab.firstElementChild.firstElementChild.children[colNr].className.substr(2);
        fld.id = tab.id+"_"+colid+rowNr;

        /*Dies dient nur Debug-Zwecken und soll Logik-Fehler durch
          copy and paste vermeiden.*/
        if (usedids[fld.id]){
          alert("Programmierfehler: id \"" + fld.id
            + "\" mehrfach vergeben!")
        } else {
          usedids[fld.id] = true;
        }
      }
      loadField(fld);
      fld.oninput = saveField;
    }

    observer = new MutationObserver(function(mutationsList,observer){
      for(const mutation of mutationsList) {
        const el = mutation.target.parentElement;
        saveElement(el);
      }
    });
    observer.observe(document,{characterData:true,subtree:true});
    loadEdits();

    for (const pageid in nclones){
      const ncl = nclones[pageid];
      let page = document.getElementById(pageid);
      for (let i=2; i<=ncl; ++i){
        page = clonePage(page);
      }
      if (ncl == 0){
        page.ncopy = 0;
        nclones[page.id] = 0;
        page.classList.add("noprint");
        page.classList.remove("doprint");
      }
    }

    npages = document.getElementsByClassName("doprint").length;
    document.documentElement.style.setProperty("--year","'"+year+"'");
    document.documentElement.style.setProperty("--npages","'/ "+npages+"'");
    npagesChanged();

    cmperpx = 21/document.getElementsByClassName("page")[0].offsetWidth;

    const gR = document.styleSheets[0].cssRules;
    for (const r of gR){
      if(r.selectorText){
        globRules[r.selectorText.replace(".","C").replace("#","I")] = r.style;
      }
    }

    updateFooters();
  };

  const removeClonedPage = function(page){
    page.parentNode.removeChild(page);
    const idsuffix = page.ncopy > 2 ? "_"+(page.ncopy-1): "";
    const lastclone = document.getElementById(page.baseid+idsuffix);
    lastclone.getElementsByClassName("guiheader")[0].style.display
      = "";//auf CSS-Wert zurücksetzen
    //wichtig ist hier nicht auf "initial" zu setzen, das würde auch
    //den @print-Stil überschreiben
    nclones[page.baseid] = lastclone.ncopy;
    setItem("..nclones",JSON.stringify(nclones));
  };

  const hidePagePrint = function(x){
    const page = x.parentNode.parentNode;
    if (page.ncopy && page.ncopy > 1){
      const conf = confirm("Wollen Sie die Seite löschen? " +
        "Sie wird nicht lediglich versteckt, sondern entfernt.");
      if (!conf){
        return;
      }
    }
    if (page.className.indexOf("noprint") == -1){
      npages -= 1;
      document.documentElement.style.setProperty("--npages",
        "'/ "+npages+"'");
      npagesChanged();
    }
    if (page.ncopy && page.ncopy > 1){
      removeClonedPage(page);
    } else {
      page.ncopy = 0;
      nclones[page.id] = 0;
      setItem("..nclones",JSON.stringify(nclones));
      page.classList.add("noprint");
      page.classList.remove("doprint");
    }
  };

  const clonePage = function(page){
    const pagecl = page.cloneNode(true);
    page.parentNode.insertBefore(pagecl,page.nextSibling);
    npages += 1;
    npagesChanged();
    document.documentElement.style.setProperty("--npages",
      "'/ "+npages+"'");
    page.ncopy = page.ncopy ? page.ncopy:1;
    page.baseid = page.baseid ? page.baseid : page.id;
    pagecl.ncopy = page.ncopy + 1;
    pagecl.baseid = page.baseid;
    nclones[page.baseid] = pagecl.ncopy;
    setItem("..nclones",JSON.stringify(nclones));
    pagecl.id = page.baseid + "_" + pagecl.ncopy;
    page.getElementsByClassName("guiheader")[0].style.display = "none";
    const desc = pagecl.querySelectorAll("*");
    for(const el of desc){
      if(el.id){
        el.baseid = el.baseid ? el.baseid : el.id;
        el.id = pagecl.id + "_" + el.baseid;
      }
    }
    const fdesc  = pagecl.querySelectorAll("input,select,textarea");
    for(const fld of fdesc){
      switch(fld.type){
        case "checkbox":
          fld.checked = false;
          break;
        default:
          fld.value = fld.defaultValue;
      }
      fld.oninput = saveField;
      loadField(fld);
    }
    return pagecl;
  };

  const hasClones = function(){
    for (const ncl of Object.values(nclones)){
      if (ncl > 1){
        return true;
      }
    }
    return false;
  };

  const warnClones = function(){
      alert("Eine modifizierte Version des Dokuments sollte nicht " +
      "mit vervielfältigten Seiten erstellt/gespeichert werden. " +
      "Bitte löschen Sie zunächst die Daten oder entfernen Sie " +
      "alle vervielfältigten Seiten.");
  };

  const warnEdit = function(){
      alert("Eine modifizierte Version des Dokuments sollte nicht " +
      "mit vervielfältigten Seiten erstellt/gespeichert werden. " +
      "Bitte speichern Sie Ihre modifizierte Version und stellen " +
      "das Editieren ab, bevor Sie Seiten vervielfältigen.");
  };


  const showPagePrint = function(plus){
    const page = plus.parentNode.parentNode;
    if (page.className.indexOf("noprint") == -1){
      if (page.className.indexOf("cloneable") == -1){
        alert("Diese Seite kann nicht vervielfältigt werden.");
      } else {
        if (allowEdits){
          warnEdit();
          return;
        }
        clonePage(page);
      }
    } else {
      page.classList.add("doprint");
      page.classList.remove("noprint");
      page.ncopy = 1;
      nclones[page.id] = 1;
      setItem("..nclones",JSON.stringify(nclones));
      npages += 1;
      npagesChanged();
      document.documentElement.style.setProperty("--npages",
        "'/ "+npages+"'");
    };
  };


//lokale Nutzung des Callbacks npagesChanged:
  npagesChanged = function(){
//     document.getElementById("seiten").defaultValue = npages;
  };
</script>
</head>
<body onload="ol()">
<div class="vhpage anleitung" id="anl">
  <div class="content">
    <h2 class="htmlonly">Was ist das?</h2>
    <p class="haupttext htmlonly">
      Dies ist die im Browser ausfüllbare Version eines Protokolls
      für Wahlen in Elternversammlungen in Klassen,
      Lerngruppen und Jahrgängen in Berlin. Sie können es
      nach dem Ausfüllen (z.B. als PDF) drucken oder als .docx-Datei
      exportieren. Was gibt es sonst noch?
    </p>
    <ul class="htmlonly">
      <li>Dieses Protokoll gibt es auch in einer
      <a href="ev-wahlprotokoll.docx">Word-Version</a>
      und einer <a href="ev-wahlprotokoll.pdf">PDF-Version</a>.
      </li>
      <li>Für die Gesamtelternvertretung (GEV) gibt es ebenfalls
      ein <a href="../gev/gev-wahlprotokoll.html">Wahlprotokoll</a>
      (<a href="../gev/gev-wahlprotokoll.docx">Word</a> |
      <a href="../gev/gev-wahlprotokoll.pdf">PDF</a>).
      </li>
      <li>Weitere Materialien (z.B. Kontaktliste) gibt es
      <a href="https://github.com/ElternmaterialBerlin/gremiendoks">hier</a>.
      </li>
      <li>Die leicht unterschiedlichen Varianten der BEAs,
      auf denen dieses Protokoll beruht, sind unten bei Autor:innen verlinkt.
      </li>
    </ul>
    <h2 class="htmlonly">Wie aktuell ist das Protokoll?</h2>
    <p class="haupttext htmlonly">
      Die letzte geprüfte Schulgesetzänderung ist vom 4.7.2024
      (AGH-Beschluss, trat 1.8.2024 bzw. 1.1.2025 in Kraft).
      Daraus ergaben sich keine notwendigen Änderungen.</p>
    <p>
      <strong>Seit 1.1.2025 gilt nach über 20 Jahren "neues"
      SchulG endlich eine aktualisierte
      <a href="https://www.berlin.de/sen/bildung/schule/rechtsvorschriften/schulgwahlo.pdf?ts=1752674592">Wahlordnung</a>.
      Die alte Wahlordnung zum Schulverfassungsgesetz ist damit endgültig
      komplett außer Kraft getreten.
      Die neue Wahlordnung wurde hier eingearbeitet; Fehler dabei oder
      weitere Anpassungen sind aber möglich. Bitte die Vorlagen für
      2024/25 und früher nicht mehr nutzen.
      </strong>
    </p>

    <h2 class="htmlonly smallonly">Bitte als Desktop-Webseite nutzen!</h2>
    <p class="haupttext htmlonly smallonly">
      Dieses Seite ist für die Desktopnutzung entworfen. Auf
      Smartphones und ggf. Tablets verwenden Sie bitte die Einstellung
      "Desktop-Webseite" (Firefox) bzw. "Desktopwebseite"
      (Chrome) bzw. "aA" → "Desktop-Webseite anfordern" (Safari ab iOS 13).
      Die mobile Ansicht, die Sie gerade sehen, kann beim Drucken als
      PDF und Export als .docx zu Formatierungsfehlern führen und ist
      primär zum (Mit)Lesen der Wahlerläuterungen gedacht.
      Sollten Sie diesen Text auf Ihrem PC oder Laptop sehen, stellen
      Sie bitte sicher, dass das Browserfenster breit genug ist.
    </p>

    <h2>Anleitung</h2>
    <p class="haupttext htmlonly">
      Dieses Dokument ist im Browser ausfüllbar. Überschriften,
      Fließtext und Tabellenköpfe sind nach Drücken der
      Schaltfläche auch editierbar und anschließend kann eine
      angepasste Version lokal gespeichert werden
      (<i>Dokument speichern</i>).
      Das Dokument wird (bis auf farbige Ränder) sehr ähnlich zur
      Bildschirmabbildung gedruckt. Sofern kein privater Modus o.ä.
      genutzt wird, werden ausgefüllte Felder und Änderungen im lokalen
      Speicher des Browsers auch nach dem Beenden gesichert
      (Tipp: testen). Die Schaltflächen <i>Daten löschen</i> bzw.
      <i>Änderungen verwerfen</i> löschen die jeweils gespeicherten
      Werte. Die Felddaten können auch exportiert und importiert
      werden. Seiten mit <i>+</i> oben rechts können
      vervielfältigt werden, Seiten mit <i>x</i> sind
      entfernbar, sodass sie nicht mitgedruckt werden, die Seitenanzahl
      passt sich jeweils automatisch an. Ebenso wird diese
      Anleitungsseite nicht gedruckt. Weil das ganze Dokument
      nur aus einer HTML-Datei besteht, können Sie es einfach
      speichern, offline nutzen und weitergeben.
    </p>
    <p class="haupttext docxonly">
      Dies ist ein docx-Export, für die ursprüngliche Web-Version
      siehe unten. Die Formularfelder (Schule, Anzahl abgegebener
      Stimmen etc.) sind als
      unterstrichener Leerraum umgesetzt, da sich echte
      Formularelemente (Fill-In) als weniger nutzbar herausgestellt
      haben. Das Dokument wird mit OnlyOffice (und seltener
      LibreOffice) getestet, kleine Fehler in MS Office sind nicht
      auszuschließen.
    </p>

    <h2 class="htmlonly">Datenschutz</h2>
    <p class="haupttext htmlonly">
      Das Formular verwendet den localStorage der
      <a href="https://developer.mozilla.org/en-US/docs/Web/API/Web_Storage_API">
      Web Storage API</a>. Das bedeutet, dass die Felddaten automatisch
      von Ihrem Browser gespeichert werden und auch nach einem
      Browserneustart verfügbar sind. Das Formular arbeitet komplett
      offline, es werden keine Felddaten an Server gesendet.
      <b>Wenn Sie auf einem fremden PC arbeiten, exportieren und
      löschen Sie die Daten am Ende (z.B. nach Druck in Datei).</b>
    </p>

    <h2>Weitergabe</h2>
    <p class="haupttext">
      Dieses Werk ist lizenziert unter der Lizenz
      <a rel="license"
        href="http://creativecommons.org/licenses/by-sa/4.0/">
        Creative Commons Namensnennung - Weitergabe unter gleichen
        Bedingungen 4.0</a>
      (bekannt als CC-BY-SA 4.0).
      Zusätzlich ist es gestattet, unter Nutzung dieses Dokuments eine
      PDF-Version oder einen Ausdruck des ganzen Dokuments oder eines
      Teils (insbesondere ohne Anleitungsseite) zu erstellen und
      ohne Namensnennung zu verbreiten und zu archivieren. Wenn Sie nur
      die GUI dieses Dokuments übernehmen und z.B. ein Dokument zu einem
      anderen Zweck erstellen, genügt es die technischen Autor:innen
      dieses Dokuments aufzulisten.
    </p>

    <p class="haupttext">
      Die jeweils aktuelle Version finden Sie unter:<br/>
      <a href="https://elternmaterialberlin.github.io/gremiendoks/ev/ev-wahlprotokoll.html">
        https://elternmaterialberlin.github.io/gremiendoks/ev/ev-wahlprotokoll.html</a><br/>
      als Teil der Materialsammlung:<br/>
      <a href="https://github.com/ElternmaterialBerlin/gremiendoks">
        https://github.com/ElternmaterialBerlin/gremiendoks</a>.<br/>

      Dort finden Sie auch weitere
      Dokumente zur Elternarbeit und können eine verbesserte Version
      dieses Dokuments einsenden.
    </p>

    <h2>Technische Autor:innen (Javascript, CSS-Stile etc.)</h2>
    <ul>
      <li> 2013-2021 (Wordvorlage: Schriftstile, Anordnung;
        Quelle s.u.)</li>
      <li> 2020-2023 Frank Fuhlbrück
        (2020: editierbare Umsetzung in HTML/CSS/Javascript; 2022: Wahlergebnisse
        auf weißem Grund; 2023: docx-Export)</li>
    </ul>

    <h2>Inhaltliche Autor:innen (Texte)</h2>
    <ul>
      <li> 2013-2021 Ursprungsversion:
        <a href="https://berliner-elternvideos.de/elternfortbildner/">
          Elternfortbilder:innen für Mitwirkungsfragen
        </a>
      </li>
      <li> 2013-2021 Anpassungen durch Bezirkselternausschüsse (u.a.
        <a href="https://bea-sz.de/dokumente/willkommenspaket-2021/wahlprotokoll-gev.html">
          Steglitz-Zehlendorf</a>,
        <a href="https://beas-mh.de/aktuell/307-willkommenspaket-2021">
          Marzahn-Hellersdorf</a>)
      </li>
      <li> 2022-2025 Frank Fuhlbrück (2022: u.a. detailliertere Erläuterungen
        + Abfrage der Stellvertreter:innenzahl;
        2023: Erläuterungen zur Rolle der Stellvertretenden;
        2025: Anpassungen an SchulGWahlO)
      </li>
    </ul>

    <h2>Haftungsausschluss</h2>
    <p class="haupttext">
      Die Autor:innen sind in der Mehrheit aktive Eltern ohne
      juristische Ausbildung. Entsprechend kann für die korrekte
      Auslegung von Gesetzen (Schulgesetz, DSGVO, etc.) keine Garantie
      gegeben werden. Falls Sie Fehler oder Unklarheiten feststellen,
      bitten wir Sie die zuletzt aktiven Autor:innen zu kontaktieren.
    </p>

    <h2>Warum HTML?</h2>
    <p class="haupttext">
      Zum Zeitpunkt der ersten Erstellung (2020-2022) ist die
      Druckdarstellung über die drei wichtigsten Desktopbrowser hinweg
      relativ konsistent. Die gewählte Implementierung erlaubt zudem
      das Anpassen von Teilen des Dokuments ohne HTML-Kenntnisse.
      Da die korrekte Verarbeitung von Stilen
      in Office-Dokumenten über Anwendungen (und Anwender:innen) hinweg
      immer wieder problematisch ist, wurde bewusst kein OOXML (.docx)
      oder OpenDocument (.odt) eingesetzt. TeX würde zwar
      konsistentere Druckdarstellung und bessere Langzeitnutzbarkeit
      desselben Dokuments erlauben, ist aber für die Elternarbeit
      zu wenig verbreitet und schließt daher viele Mitarbeitende aus.
      Seit 2023 ist Export als docx möglich, diese Datei wird
      direkt aus der HTML-Seite generiert, profitiert also von
      zukünftigen Änderungen dieser.
    </p>

    <h2 class="htmlonly">Drucktipps</h2>
    <p class="haupttext htmlonly">
      Kopf- und Fußzeilen des Browsers müssen ausgestellt und
      das Drucken vom Hintergrund (Firefox) bzw.
      Hintergrundgrafiken (Chrome) erlaubt werden. Zudem sollten
      keine Schriftarten erzwungen werden, da sonst z.B. der Inhalt nicht
      auf die Seite passt.
      Falls Sie eine zusätzliche leere Seite in der Druckvorschau
      bekommen (beobachtet in Safari), stellen Sie die Skalierung auf
      99% oder weniger ein. Unter Android kann man direkt aus
      Firefox seit Version 69 keine PDFs mehr erstellen
      (zumindest nicht mit den nötigen Einstellungen), mit Chrome
      wählt man <i>Teilen</i> und dann <i>Drucker</i>
      (auch für PDF-Export).
    </p>
  </div>
</div>
<div class="page doprint" id="kesp">
  <div class="content">
    <h1>Wahlprotokoll der Klassenelternversammlung
    </h1>
    <p class="subhead">
      (basierend auf dem Schulgesetz des Landes
      Berlin (SchulG) und der Wahlordnung zum Schulgesetz (SchulGWahlO))
    </p>
    <table class="tabelleohnerahmen">
      <tr>
        <td id="schulez"><!--
          --><label for="schule">Schule:</label>
          <input type="text" id="schule" name="schule" value="" />
        </td>
        <td id="klassez">
          <label for="klasse">Klasse:</label>
          <input type="text" id="klasse" name="klasse" value="" />
        </td>
        <td id="datumz">
          <label for="datum">Zeitpunkt:</label>
          <input type="text" id="datum" name="datum" value="" />
        </td>
      </tr>
    </table>
    <h2>1. Feststellung der anwesenden Wahlberechtigten und der Stimmenzahl</h2>

    <p class="haupttext">
      <label for="anwesend">Anwesend sind</label>
      <input id="anwesend" name="anwesend" value=""/>
      Wahlberechtigte mit
      <input id="stimmen" name="stimmen" value=""/>
      <label for="stimmen">Stimmen</label>
      (siehe Anwesenheitsliste als Anlage).
    </p>

    <h2>2. Wahl (oder Bestimmung) der Wahlleitung</h2>
    <p class="haupttext">
      <label for="wahlleitung">Wahlleitung:</label>
      <input type="text" id="wahlleitung" name="wahlleitung" value="" />
    </p>

    <h2>3. Durchführung der Wahl und Erfassung der Kandidierenden</h2>

    <h4>
      Kandidierende als Elternsprecherin oder
      Elternsprecher der Klasse
    </h4>

    <table id=kandkesp class="tabellebreit" data-nrows="4">
      <thead><tr>
        <th class="spnamen">Name</th>
        <th class="spanz">Anzahl der Stimmen</th>
      </tr></thead>
      <tbody></tbody>
    </table>

    <p class="haupttext">
      <label for="kesptyp">Wahlart:</label>
      <input id="kesptyp" name="kesptyp" class="wahltyp" /> &nbsp;
      <label for="kespenth">Enthaltungen:</label>
      <input id="kespenth" name="kespenth" class="anz" /> &nbsp;
      <label for="kespung">ungültige Stimmen:</label>
      <input id="kespung" name="kespung" class="anz" /> &nbsp;
      <label for="kespges">Anzahl Stimmzettel:</label>
      <input id="kespges" name="kespges" class="anz" />
    </p>
    <p class="erlaeuterung">
      (bei &gt; 4 Kandidierenden bitte Extrablatt nutzen; Wahlart: geheim/offen/Block; Anzahl Stimmzettel nur bei geheimer Wahl)
    </p>


    <h5>
      Wahlergebnis Klassenelternsprecherinnen / Klassenelternsprecher
    </h5>

    <table id=wekesp class="tabellebreit wahlerg" data-nrows="2">
      <thead><tr>
        <th class="spnamen">Name</th>
        <th class="spkontakt">E-Mail / Telefon</th>
      </tr></thead>
      <tbody></tbody>
    </table>

    <h4>
      Kandidierende für stellvertretende Elternsprecherinnen oder
      Elternsprecher der Klasse
    </h4>

    <p class="haupttext">
      <label for="stvkesp">Es sollen </label>
      <input id="stvkesp" name="stvkesp" class="anz" />
      stellvertretende Elternsprecherinnen oder
      Elternsprecher gewählt werden.
      <a class="erlaeuterung">(maximal 4)</a>
    </p>

    <table id=kandstvkesp class="tabellebreit" data-nrows="4">
      <thead><tr>
        <th class="spnamen">Name</th>
        <th class="spanz">Anzahl der Stimmen</th>
      </tr></thead>
      <tbody></tbody>
    </table>

    <p class="haupttext">
      <label for="stvkesptyp">Wahlart:</label>
      <input id="stvkesptyp" name="stvkesptyp" class="wahltyp" /> &nbsp;
      <label for="stvkespenth">Enthaltungen:</label>
      <input id="stvkespenth" name="stvkespenth" class="anz" /> &nbsp;
      <label for="stvkespung">ungültige Stimmen:</label>
      <input id="stvkespung" name="stvkespung" class="anz" /> &nbsp;
      <label for="stvkespges">Anzahl Stimmzettel:</label>
      <input id="stvkespges" name="stvkespges" class="anz" />
    </p>
    <p class="erlaeuterung">
      (bei &gt; 4 Kandidierenden bitte Extrablatt nutzen; Wahlart: geheim/offen/Block; Anzahl Stimmzettel nur bei geheimer Wahl)
    </p>

    <h5>
      Wahlergebnis stellvertretende Klassenelternsprecherinnen / Klassenelternsprecher
    </h5>

    <table id=westvkesp class="tabellebreit wahlerg" data-nrows="4">
      <thead><tr>
        <th class="sprang">&#35;</th>
        <th class="spnamen">Name</th>
        <th class="spkontakt">E-Mail / Telefon</th>
      </tr></thead>
      <tbody></tbody>
    </table>
  </div>
  <div class="footerl">
    Wahlprotokoll Klassen-EV <a class="yr"></a><br/>
  </div>
  <div class="footerr">
    Seite <a class="pn"></a>  <a class="np"></a>
  </div>
<!-- GUI-Header erste Seite -->
  <div class="guiheader guiheader_edit">
    <a class="guielement_small"
      onclick="flipEdit();">Editieren an/aus</a>
    <a class="guielement_small"
      onclick="dlSelf();">Dokument speichern</a>
    <a class="guielement_small"
      onclick="revertEdits();">Änderungen verwerfen</a>
  </div>
  <div class="guiheader">
    <a class="guielement_small"
      onclick="clearFields();">Daten löschen</a>
    <a class="guielement_small"
      onclick="exportFields();">Daten exportieren</a>
    <a class="guielement_small"
      onclick="importFields();">Daten importieren</a>
    <a class="guielement_small"
      onclick="saveDocx();">als docx speichern</a>
  </div>
<!-- ENDE GUI-Header erste Seite -->
</div>


<div class="page doprint" id="stvkesp">
  <div class="content">

    <h4>
      Kandidierende für die Mitglieder der Klassenkonferenz
    </h4>

    <table id=kandklko class="tabellebreit" data-nrows="3">
      <thead><tr>
        <th class="spnamen">Name</th>
        <th class="spanz">Anzahl der Stimmen</th>
      </tr></thead>
      <tbody></tbody>
    </table>

    <p class="haupttext">
      <label for="klkosptyp">Wahlart:</label>
      <input id="klkosptyp" name="klkosptyp" class="wahltyp" /> &nbsp;
      <label for="klkospenth">Enthaltungen:</label>
      <input id="klkospenth" name="klkospenth" class="anz" /> &nbsp;
      <label for="klkospung">ungültige Stimmen:</label>
      <input id="klkospung" name="klkospung" class="anz" /> &nbsp;
      <label for="klkospges">Anzahl Stimmzettel:</label>
      <input id="klkospges" name="klkospges" class="anz" />
    </p>
    <p class="erlaeuterung">
      (bei &gt; 3 Kandidierenden bitte Extrablatt nutzen; Wahlart: geheim/offen/Block; Anzahl Stimmzettel nur bei geheimer Wahl)
    </p>

    <h5>
      Wahlergebnis Mitglieder der Klassenkonferenz
    </h5>

    <table id=weklko class="tabellebreit wahlerg" data-nrows="2">
      <thead><tr>
        <th class="spnamen">Name</th>
        <th class="spkontakt">E-Mail / Telefon</th>
      </tr></thead>
      <tbody></tbody>
    </table>

    <h4>
      Kandidierende für stellvertretende Mitglieder der Klassenkonferenz
    </h4>

    <p class="haupttext">
      <label for="stvklko">Es sollen </label>
      <input id="stvklko" name="stvklko" class="anz" />
      stellvertretende Mitlieder der Klassenkonferenz gewählt werden.
      <a class="erlaeuterung">(maximal 4)</a>
    </p>

    <table id=kandstvklko class="tabellebreit" data-nrows="3">
      <thead><tr>
        <th class="spnamen">Name</th>
        <th class="spanz">Anzahl der Stimmen</th>
      </tr></thead>
      <tbody></tbody>
    </table>

    <p class="haupttext">
      <label for="stvklkosptyp">Wahlart:</label>
      <input id="stvklkosptyp" name="stvklkosptyp" class="wahltyp" /> &nbsp;
      <label for="stvklkospenth">Enthaltungen:</label>
      <input id="stvklkospenth" name="stvklkospenth" class="anz" /> &nbsp;
      <label for="stvklkospung">ungültige Stimmen:</label>
      <input id="stvklkospung" name="stvklkospung" class="anz" /> &nbsp;
      <label for="stvklkospges">Anzahl Stimmzettel:</label>
      <input id="stvklkospges" name="stvklkospges" class="anz" />
    </p>
    <p class="erlaeuterung">
      (bei &gt; 3 Kandidierenden bitte Extrablatt nutzen; Wahlart: geheim/offen/Block; Anzahl Stimmzettel nur bei geheimer Wahl)
    </p>

    <h5>
      Wahlergebnis stellvertretende Mitglieder der Klassenkonferenz
    </h5>

    <table id=westvklko class="tabellebreit wahlerg" data-nrows="4">
      <thead><tr>
        <th class="sprang">&#35;</th>
        <th class="spnamen">Name</th>
        <th class="spkontakt">E-Mail / Telefon</th>
      </tr></thead>
      <tbody></table>
    <p></p>

  <h2>4. Einspruchsrecht und Unterschrift(en) der Wahlleiter:innen
    und Helfer:innen
    </h2>
    <p class="haupttext">
    Einspruch gegen die Wahlen oder Wahldurchführung sind innerhalb
    einer Woche schriftlich begründet bei der Wahlleitung oder der
    Schulleitung einzulegen.
    </p>

    <table id=wahlleitus class="tabellebreit doppelzeilen">
      <thead><tr>
        <th class="spnamen">Name</th>
        <th class="spwg">
          geleitete Wahlen
        </th>
        <th class="sphi">
          Helfer:in bei
        </th>
        <th class="spunters">Unterschrift</th>
      </tr></thead>
      <tbody>
        <tr>
          <td><input class="iptab"/></td>
          <td><textarea class="iptab"></textarea></td>
          <td><textarea class="iptab"></textarea></td>
          <td></td>
        </tr>
        <tr>
          <td><input class="iptab"/></td>
          <td><textarea class="iptab"></textarea></td>
          <td><textarea class="iptab"></textarea></td>
          <td></td>
        </tr>
        <tr>
          <td><input class="iptab"/></td>
          <td><textarea class="iptab"></textarea></td>
          <td><textarea class="iptab"></textarea></td>
          <td></td>
        </tr>
      </tbody>
    </table>

  </div>


  <div class="footerl">
    Wahlprotokoll Klassen-EV <a class="yr"></a><br/>
  </div>
  <div class="footerr">
    Seite <a class="pn"></a>  <a class="np"></a>
  </div>
</div>

<div class="page doprint" id="erlaeuterungen">
  <div class="content">

    <h3>
      Erläuterungen zum Wahlprotokoll der Klassenelternversammlung
    </h3>

    <h2>1. Feststellung der anwesenden Wahlberechtigten und der Stimmenzahl</h2>
    <p class="haupttext">
      Wahlberechtigt/stimmberechtigt sind bei einer Elternversammlung
      nach § 89 die anwesenden Erziehungsberechtigten.
      Für jedes Kind können zwei Stimmen abgeben werden, auch wenn nur
      ein*e Erziehungsberechtigte*r anwesend ist.
      Eltern können Ihre Stimme auf z.B. Großeltern übertragen,
      SchulG Berlin § 88 (4):
      <em>
      Die Mitwirkungsrechte der Erziehungsberechtigten können an
      Stelle der oder neben den Sorgeberechtigten diejenigen
      volljährigen Personen wahrnehmen, denen die Erziehung des Kindes
      mit Einverständnis der Sorgeberechtigten anvertraut oder mit
      anvertraut ist; das Einverständnis ist der Schule auf Verlangen
      schriftlich nachzuweisen.</em>
      Dies ist aber auf enge Vertraute des Kindes beschränkt
      (siehe
      <a href="https://pardok.parlament-berlin.de/starweb/adis/citat/VT/17/KlAnfr/ka17-12242.pdf">
      AGH Drucksache 17/12242</a>).
      Jede Person darf maximal vier Stimmen abgeben (wichtig z.B.
      bei Geschwistern in einer Klasse).
    </p>

    <h2>2. Wahl der Wahlleitung</h2>
    <p class="haupttext">
      <em>§ 4 (1) SchulGWahlO:
      Die Leitung einer Wahl obliegt der Wahlleiterin oder dem
      Wahlleiter. Die Wahlleitung übernimmt ein nicht kandidierendes
      Mitglied oder eine nicht dem Gremium, der Versammlung oder der
      jeweiligen Gesamtheit der Wahlberechtigten angehörende Person.
      </em>
    </p>

    <p class="haupttext">
      <em>§ 4 (2) SchulGWahlO:
      Die Wahlberechtigten wählen die Wahlleiterin oder den Wahlleiter
      in offener Abstimmung. Die Abstimmung führt durch, wer den
      Wahltermin bekanntgegeben hat oder eine von ihm oder ihr
      beauftragte Person, die die Sitzung oder Versammlung, in der die
      Wahl durchgeführt wird, leitet. Sofern sich bei Wahlen in den
      Schulen aus der Abstimmung eine Wahlleiterin oder ein Wahlleiter
      nicht ergibt, leitet die Schulleiterin oder der Schulleiter oder
      eine von ihr oder ihm beauftragte Lehrkraft die Wahl. [...]
      </em>
    </p>

    <p class="haupttext">
      Für die Elternversammlung heißt das: die bisherigen
      Elternvertreter:innen (die den Termin nach § 3 SchulGWahlO
      bestimmen und nach § 89 (3,4) SchulG einladen) leiten idR die
      Abstimmung zur Wahlleitung. Bei einer neu gebildeten Klasse
      (oder Jahrgangsstufe, z.B. in Klassenstufe 11) tut dies
      die/der Klassenlehrer:in. Sinnvollerweise beauftragt die
      Schulleitung auch die/den Klassenlehrer:in dazu im Falle einer
      Nichteinigung die Wahl zu leiten. Theoretisch darf die
      Wahlleitung auch wechseln (d.h. für jede Wahl einzeln bestimmt
      werden). Allerdings erlaubt § 4 (4) SchulGWahlO die Hinzuziehung
      von Helfenden je Wahlgang, die fast alle Aufgaben der Wahlleitung
      übernehmen können. Insofern kann die formelle Wahlleitung auch
      von einer unerfahrenen Person übernommen werden, die in jedem
      Wahlgang Helfende aus den jeweils
      nicht kandidierenden Eltern bestimmt.
    </p>

    <h2>3. Durchführung der Wahl und Erfassung der Kandidierenden</h2>
    <p class="haupttext">
      Wahlen sind grundsätzlich geheim und müssen daher per
      Stimmzettel durchgeführt werden. Dabei wird der Name der
      kandidierenden Person(en) auf Zettel geschrieben. Auf Antrag und
      durch einstimmigen Beschluss der anwesenden Wahlberechtigten
      kann offen gewählt werden. Jede/jeder Wahlberechtigte
      kann auf dem Stimmzettel so vielen Bewerberinnen und Bewerbern
      die Stimme geben, wie Personen zu wählen sind. <b>
      Eine Stimme im Sinne des SchulG entspricht einem Stimmzettel,
      der wiederum mehrere Personen enthalten darf.</b>
      Bei einer einstimmigen offenen Wahl im Block erhalten allen
      Kandidierenden beispielsweise die Gesamtzahl der Stimmen.
      <strong>
      Nach SchulGWahlO § 5 genügt es, falls nicht mehr
      Personen kandidieren als Posten zu besetzten sind, nicht,
      nur die Namen (nicht) auf die Stimmzettel zu schreiben.
      Jeder Name muss dann mit Ja/Nein/Enthaltung versehen sein.
      Entsprechend sollten auch alle drei Anzahlen je Person
      getrennt im Protokoll erfasst werden.
      </strong>

      Bevor Stellvertreter:innen gewählt werden, wird
      deren Anzahl abgestimmt.
      Bei Stimmengleichheit findet (sofern nötig) eine Stichwahl
      statt, besteht diese fort, wird gelost.
    </p>

    <h2>4. Stellvertretende allgemein</h2>
    <p class="haupttext">
    § 2 (5) SchulGWahlO verlangt eine explizite Reihenfolge
    der Stellvertretenden,
    <em>soweit [...] die Versammlung nichts anderes bestimmt.</em>
    Die Standardreihenfolge ist nach Stimmenzahl mit Losentscheid bei
    Gleichstand. Statt Los können sich die Stellvertretenden aber
    auch untereinander einigen.
    </p>

    <h2>5. Rolle der stellvertretenden Klassenelternsprecher:innen</h2>
    <p class="haupttext">
      Das Schulgesetz sieht nur für die/den Elternsprecher*in
      der ganzen Schule explizit Stellvertretende vor. Allerdings
      sind für jedes Gremienmitglied 1-2 Stellvertretende
      zu wählen. Da die Gesamtelternvertretung ein Gremium ist
      und die Klassenelternsprecher:innen dort Mitglied sind,
      sind also zumindest für diese Funktion auch Stellvertretende
      zu wählen. Dass diese auch die Elternversammlung bei Abwesenheit
      der Klassenelternsprecher:innen vorbereiten und leiten,
      ist so nicht vorgesehen. Alle weiteren De-Facto-Aufgaben
      für die Eltern der Klasse (mancherorts Klassenkasse,
      Kommunikation, Basare u.ä.) sind ohnehin nicht im Gesetz
      angelegt und können beliebig verteilt werden. In der Praxis
      besteht der Unterschied zwischen Klassenelternsprecher:innen
      und Stellvertretenden also v.a. im aktiven und passiven
      Wahlrecht in der GEV, ansonsten bietet es sich an, alle als Team
      zu sehen.
    </p>
  </div>

  <div class="footerl">
    Wahlprotokoll Klassen-EV - Erläuterungen <a class="yr"> </a><br/>
  </div>
  <div class="footerr">
    Seite <a class="pn"></a>  <a class="np"></a>
  </div>

  <div class="guiheader">
    <a class="guielement"
      onclick="hidePagePrint(this);">
      <span class="lesspages"></span>
    </a>
    <a class="guielement"
      onclick="showPagePrint(this);">
      <span class="morepages"></span>
    </a>
  </div>
</div>


</body>
</html>
